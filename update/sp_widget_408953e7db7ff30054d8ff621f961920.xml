<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function($scope, $location, spUtil) {
  /* widget controller */
  var c = this;
	var s = $location.search();
	
	c.addEnrollment = function(table){
		s.id = 'fcsms_intake_form';
		$location.search(s).replace();
	}
	
	
	c.reviewIntakeForm = function(sys_id){
		s.id = 'fcsms_intake_form';
		s.sys_id = sys_id;
		$location.search(s).replace();
	}
	
	c.reviewStudyConsent = function(sys_id){
		/*
		s.id = 'fcsms_consent_form_list';
		s.sys_id = sys_id;
		$location.search(s).replace();
		*/
	}
	
	c.reviewFHQ = function(sys_id){
		s.id = 'fcsms_fhq';
		s.sys_id = sys_id;
		$location.search(s).replace();
	}
	
	c.reviewIIQ = function(sys_id){
		s.id = 'fcsms_iiq_list';
		s.sys_id = sys_id;
		$location.search(s).replace();
	}
	
	/*
	
	var widg = '<sp-widget widget="c.data.widget_add"></sp-widget>';
	
	var el = $compile(widg)($scope);
	
	console.log(el);
	console.log('--------');
	
	$('#test-widge-loading').append(el, function(index, html){
		console.log("start....");
		console.log(html);
	});
	*/
}]]></client_script>
        <controller_as>c</controller_as>
        <css>.enrollment-row {
  border-bottom: 1px solid lightgray;
}
.enrollment-row:hover{
  background-color:lightgray;
}
.enrollment_detail{
  width:100%;
  background-color:white;
  border-top:1px solid lightgray;
  height:auto;
}
.btn-font{
  font-size: 16px;
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>fcsms_table_list</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>FCSMS Table List</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
  /* populate the 'data' object */
  /* e.g., data.table = $sp.getValue('table'); 
	*/
	data.records = [];
	var gr = new GlideRecord('x_naci_family_coho_mock_up_intake');
	gr.orderBy('sys_created_on');
	gr.query();
	while(gr.next()){
		var tmp = {};
		tmp.sys_id = gr.sys_id.toString();
		tmp.family_id = gr.family_id.toString();
		tmp.enrollment_id = gr.number.toString();
		tmp.informant = 'Smith';
		tmp.er_status = gr.enrollment_status.toString();
		tmp.es_status = gr.eligible_status.toString();
		tmp.mail = gr.communication_type.toString();
		tmp.intake = 1;
		tmp.consent = tmp.er_status != 'Intake Form Submitted' ? 1 : 0;
		tmp.fhq = (tmp.er_status != 'Intake Form Submitted' && tmp.er_status != 'Study Consent Submitted') ? 1 : 0;
		tmp.iiq = tmp.er_status == 'FHQ/IIQ/MRR Submitted' ? 1 : 0;
		data.records.push(tmp);
	}
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>yuw5@nih.gov</sys_created_by>
        <sys_created_on>2019-09-16 13:31:46</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>408953e7db7ff30054d8ff621f961920</sys_id>
        <sys_mod_count>423</sys_mod_count>
        <sys_name>FCSMS Table List</sys_name>
        <sys_package display_value="Family Cohort Study" source="x_naci_family_coho">090e9eb7dba7774054d8ff621f9619eb</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Family Cohort Study">090e9eb7dba7774054d8ff621f9619eb</sys_scope>
        <sys_update_name>sp_widget_408953e7db7ff30054d8ff621f961920</sys_update_name>
        <sys_updated_by>yuw5@nih.gov</sys_updated_by>
        <sys_updated_on>2019-10-01 15:38:51</sys_updated_on>
        <template><![CDATA[<div id="container" style="height: 400px; font-size:20px;margin-left: 30px;">
  <h2 style="text-align:left;font-weight:bold;">Enrollment Activities</h2>
  <div style="width: 100%;">
    <div class="col-md-6">
      <widget id="fcsms_report_enroll_received"></widget>
    </div>
    <div class="col-md-6">
      <widget id="fcsms_report_enroll_total"></widget>
    </div>
  </div>
  
</div>
<div id="container" style="font-size:20px;margin-left: 30px;">

  <div style="margin-bottom:5px;height:40px;">
    <div class="col-md-6" style="">
      <label style="text-align:left;font-weight:bold;font-size:30px;">Enrollment List</label>
    </div>
    <div class="col-md-6" style="position: relative;">
      <button class="btn btn-primary btn-font" ng-click="c.addEnrollment()" style="padding: 5px 50px;position: absolute;right: 0px;">
        Create new Enrollment
      </button>
    </div>
  </div>
  
  <div class="container" style="width:100%;display:flex;padding:10px 0px;background-color:#428bca;color:white;">
    <div class="col-md-1">
      Enrollment ID
    </div>
    <div class="col-md-2">
      Informant/Proband
    </div>
    <div class="col-md-2">
      Enrollment Status
    </div>
    <div class="col-md-2">
      Eligible Status
    </div>
    <div class="col-md-1">
      Mail
    </div>
    <div class="col-md-1">
      Intake
    </div>
    <div class="col-md-1">
      Study Consent
    </div>
    <div class="col-md-1">
      FHQ
    </div>
    <div class="col-md-1">
      IIQ
    </div>
  </div>
  <div id="enrollment_{{record.enrollment_id}}" class="enrollment-row" style="width:100%;display:inline-block;padding:10px 0px;" ng-repeat="record in c.data.records">
    	<div class="col-md-1">
        {{ record['enrollment_id'] || 'N/A' }}  
      </div>
      <div class="col-md-2">
        {{ record['informant'] || 'N/A' }}  
      </div>
      <div class="col-md-2">
        {{ record['er_status'] || 'N/A' }}  
      </div>
      <div class="col-md-2">
        {{ record['es_status'] || 'N/A' }}  
      </div>
      <div class="col-md-1">
        {{ record['mail'] == 'Mail' ? 'Yes' : 'No' || 'N/A' }}  
      </div>
      <div class="col-md-1">
        <a ng-click="c.reviewIntakeForm(record.sys_id)" ng-show="record['intake'] == '1'">View</a>  
        </div>
      <div class="col-md-1">
        <a ng-click="c.reviewStudyConsent(record.sys_id)" ng-show="record['consent'] == '1'">View</a>
      </div>
      <div class="col-md-1">
        <a ng-click="c.reviewFHQ(record.sys_id)" ng-show="record['fhq'] == '1'">View</a>
        </div>
      <div class="col-md-1">
          <a ng-click="c.reviewIIQ(record.sys_id)" ng-show="record['iiq'] == '1'">View</a>  
      </div>
  </div>
  
  <!--
    <div id="test-widge-loading">
      <sp-widget widget="c.catalogItemWidget"></sp-widget>
    </div>
  -->]]></template>
    </sp_widget>
</record_update>
